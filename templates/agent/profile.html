{% extends 'base.html' %}
{% block title %}My Profile{% endblock %}

{% block content %}
<div class="container py-4">
    <div class="row">
        <div class="col-lg-8 mx-auto">
            <h3 class="fw-bold mb-4"><i class="bi bi-person-gear"></i> My Profile</h3>

            <div class="card border-0 shadow-sm">
                <div class="card-body p-4">
                    <form method="POST" enctype="multipart/form-data">
                        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

                        <div class="text-center mb-4">
                            {% if current_user.photo %}
                            <img src="{{ url_for('static', filename='uploads/users/' + current_user.photo) }}" class="rounded-circle mb-2" style="width:100px;height:100px;object-fit:cover" alt="Profile">
                            {% else %}
                            <div class="bg-primary text-white rounded-circle d-inline-flex align-items-center justify-content-center mb-2" style="width:100px;height:100px;font-size:2.5rem;font-weight:bold">
                                {{ current_user.name[0] }}
                            </div>
                            {% endif %}
                            <div>
                                <span class="badge bg-primary">{{ current_user.role|title }}</span>
                                {% if current_user.is_approved %}
                                <span class="badge bg-success">Approved</span>
                                {% else %}
                                <span class="badge bg-warning text-dark">Pending Approval</span>
                                {% endif %}
                            </div>
                        </div>

                        <div class="row g-3">
                            <div class="col-md-6">
                                <label class="form-label fw-bold">Full Name</label>
                                <input type="text" name="name" class="form-control" value="{{ current_user.name }}">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label fw-bold">Email</label>
                                <input type="email" class="form-control" value="{{ current_user.email }}" disabled>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label fw-bold">Phone</label>
                                <input type="tel" name="phone" class="form-control" value="{{ current_user.phone }}">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label fw-bold">Company</label>
                                <input type="text" name="company" class="form-control" value="{{ current_user.company or '' }}">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label fw-bold">RERA Number</label>
                                <input type="text" name="rera_number" class="form-control" value="{{ current_user.rera_number or '' }}">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label fw-bold">Profile Photo</label>
                                <input type="file" name="photo" class="form-control" accept="image/*">
                            </div>
                            <div class="col-12">
                                <button type="submit" class="btn btn-primary px-4">
                                    <i class="bi bi-check-circle"></i> Save Changes
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
