{% extends 'base.html' %}
{% block title %}Find Properties in Mumbai | Exproperty{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="hero-section text-white">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 mx-auto text-center">
                <h1 class="mb-3">Find Your Dream<br>Property in <span class="text-warning">Mumbai</span></h1>
                <p class="lead mb-4">Explore thousands of verified properties across Mumbai â€” Flats, Villas, Offices & more</p>

                <!-- Search Box -->
                <div class="hero-search text-start">
                    <form action="{{ url_for('public.properties') }}" method="GET">
                        <div class="row g-3">
                            <div class="col-md-3">
                                <select name="listing_type" class="form-select">
                                    <option value="">Buy / Rent</option>
                                    <option value="buy">Buy</option>
                                    <option value="rent">Rent</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <select name="property_type" class="form-select">
                                    <option value="">Property Type</option>
                                    <option value="flat">Flat / Apartment</option>
                                    <option value="house">House</option>
                                    <option value="villa">Villa</option>
                                    <option value="office">Office</option>
                                    <option value="shop">Shop</option>
                                    <option value="plot">Plot</option>
                                    <option value="warehouse">Warehouse</option>
                                </select>
                            </div>
                            <div class="col-md-4">
                                <select name="locality" class="form-select">
                                    <option value="">All Localities</option>
                                    {% for zone_name, locs in zones.items() %}
                                    <optgroup label="{{ zone_name }}">
                                        {% for loc in locs %}
                                        <option value="{{ loc.id }}">{{ loc.name }}</option>
                                        {% endfor %}
                                    </optgroup>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="col-md-2">
                                <button type="submit" class="btn btn-primary w-100">
                                    <i class="bi bi-search"></i> Search
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Featured Properties -->
{% if featured %}
<section class="py-5">
    <div class="container">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h2 class="section-title">Featured Properties</h2>
            <a href="{{ url_for('public.properties') }}" class="btn btn-outline-primary btn-sm">View All <i class="bi bi-arrow-right"></i></a>
        </div>
        <div class="featured-scroll">
            {% for prop in featured %}
            <a href="{{ url_for('public.property_detail', slug=prop.slug) }}" class="text-decoration-none">
                <div class="card property-card">
                    <div class="card-img-wrapper">
                        {% if prop.primary_image %}
                        <img src="{{ url_for('static', filename='uploads/properties/thumbs/' + prop.primary_image.filename) }}" alt="{{ prop.title }}" loading="lazy">
                        {% else %}
                        <div class="no-image"><i class="bi bi-building"></i></div>
                        {% endif %}
                        <span class="price-badge">{{ prop.formatted_price }}</span>
                        <span class="type-badge">{{ prop.listing_type }}</span>
                        {% if prop.is_featured %}<span class="featured-badge"><i class="bi bi-star-fill"></i> Featured</span>{% endif %}
                    </div>
                    <div class="card-body">
                        <h5 class="card-title">{{ prop.title }}</h5>
                        <div class="prop-meta">
                            {% if prop.bhk %}<span><i class="bi bi-door-open"></i> {{ prop.bhk }} BHK</span>{% endif %}
                            {% if prop.area_sqft %}<span><i class="bi bi-arrows-angle-expand"></i> {{ prop.area_sqft|int }} sqft</span>{% endif %}
                            {% if prop.floor_number is not none %}<span><i class="bi bi-layers"></i> Floor {{ prop.floor_number }}</span>{% endif %}
                        </div>
                        {% if prop.locality %}
                        <div class="prop-location mt-2">
                            <i class="bi bi-geo-alt-fill"></i> {{ prop.locality.name }}, {{ prop.locality.zone }}
                        </div>
                        {% endif %}
                    </div>
                </div>
            </a>
            {% endfor %}
        </div>
    </div>
</section>
{% endif %}

<!-- Browse by Locality / Zone -->
<section class="py-5 bg-light">
    <div class="container">
        <h2 class="section-title mb-4">Browse by Location</h2>
        <div class="row g-3">
            {% set zone_images = {
                'South Mumbai': 'https://images.unsplash.com/photo-1529253355930-ddbe423a2ac7?w=400',
                'Western Suburbs': 'https://images.unsplash.com/photo-1567157577867-05ccb1388e13?w=400',
                'Central Suburbs': 'https://images.unsplash.com/photo-1580587771525-78b9dba3b914?w=400',
                'Harbour Line': 'https://images.unsplash.com/photo-1545324418-cc1a3fa10c00?w=400',
                'Thane': 'https://images.unsplash.com/photo-1600596542815-ffad4c1539a9?w=400',
                'Navi Mumbai': 'https://images.unsplash.com/photo-1600585154340-be6161a56a0c?w=400'
            } %}
            {% for zone_name, locs in zones.items() %}
            <div class="col-lg-4 col-md-6">
                <a href="{{ url_for('public.properties', zone=zone_name) }}" class="text-decoration-none">
                    <div class="locality-card">
                        <img src="{{ zone_images.get(zone_name, 'https://images.unsplash.com/photo-1580587771525-78b9dba3b914?w=400') }}" alt="{{ zone_name }}" loading="lazy">
                        <div class="overlay">
                            <div>
                                <h6>{{ zone_name }}</h6>
                                <small>{{ locs|length }} localities</small>
                            </div>
                        </div>
                    </div>
                </a>
            </div>
            {% endfor %}
        </div>
    </div>
</section>

<!-- Property Types -->
<section class="py-5">
    <div class="container">
        <h2 class="section-title mb-4">Property Types</h2>
        <div class="row g-3">
            {% set types = [
                ('flat', 'bi-building', 'Flats & Apartments'),
                ('villa', 'bi-house-door', 'Villas'),
                ('house', 'bi-house', 'Houses'),
                ('office', 'bi-briefcase', 'Offices'),
                ('shop', 'bi-shop', 'Shops'),
                ('plot', 'bi-grid-3x3-gap', 'Plots & Land')
            ] %}
            {% for type_val, icon, label in types %}
            <div class="col-lg-2 col-md-4 col-6">
                <a href="{{ url_for('public.properties', property_type=type_val) }}" class="type-icon-card">
                    <i class="bi {{ icon }}"></i>
                    <h6>{{ label }}</h6>
                </a>
            </div>
            {% endfor %}
        </div>
    </div>
</section>

<!-- Stats -->
<section class="stats-section py-5 text-white">
    <div class="container">
        <div class="row text-center g-4">
            <div class="col-md-4">
                <div class="stat-item">
                    <h3>{{ total_properties }}+</h3>
                    <p>Properties Listed</p>
                </div>
            </div>
            <div class="col-md-4">
                <div class="stat-item">
                    <h3>{{ total_agents }}+</h3>
                    <p>Verified Agents</p>
                </div>
            </div>
            <div class="col-md-4">
                <div class="stat-item">
                    <h3>{{ total_localities }}+</h3>
                    <p>Mumbai Localities</p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- CTA -->
<section class="py-5 text-center">
    <div class="container">
        <h2 class="fw-bold mb-3">Are you an Agent or Broker?</h2>
        <p class="text-muted mb-4">Register and start listing your properties to reach thousands of buyers</p>
        <a href="{{ url_for('auth.register') }}" class="btn btn-primary btn-lg px-5">
            <i class="bi bi-person-plus"></i> Register Now
        </a>
    </div>
</section>
{% endblock %}
